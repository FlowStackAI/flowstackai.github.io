<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FlowStack - Modern Income Education</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
/* --- Originalni dizajn --- */
* { margin:0; padding:0; box-sizing:border-box; font-family:Arial,sans-serif; }
body { background:linear-gradient(135deg,#0f1b3a 0%,#1e3a8a 50%,#0f1b3a 100%); color:#333; min-height:100vh; padding:20px; line-height:1.6;}
.container { max-width:1000px; margin:0 auto; padding:40px 20px; background:rgba(255,255,255,0.95); border-radius:15px; box-shadow:0 20px 60px rgba(0,0,0,0.3); position:relative; z-index:2; backdrop-filter:blur(10px);}
header{text-align:center; margin-bottom:40px;}
.logo-container{margin-bottom:30px;}
.logo{width:200px;height:200px;margin:0 auto 20px;display:flex;align-items:center;justify-content:center;font-size:120px;}
h1{font-size:42px;margin-bottom:15px;background:linear-gradient(45deg,#4a6cf7,#6a11cb);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:bold;}
.subtitle{font-size:20px;opacity:0.8;margin-bottom:10px;color:#666;}
.value-proposition{background:linear-gradient(135deg,#f8faff 0%,#eef2ff 100%);padding:40px;border-radius:12px;margin:50px 0;border-left:4px solid #4a6cf7;box-shadow:0 8px 25px rgba(0,0,0,0.1);}
.features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin:50px 0;}
.feature-card{background:linear-gradient(135deg,#fff 0%,#f8faff 100%);padding:35px;border-radius:12px;border:2px solid;transition:all 0.3s ease;box-shadow:0 8px 25px rgba(0,0,0,0.1);text-align:center;}
.feature-card:nth-child(1){border-color:#4a6cf7;background:linear-gradient(135deg,#fff 0%,#f0f4ff 100%);}
.feature-card:nth-child(2){border-color:#6a11cb;background:linear-gradient(135deg,#fff 0%,#f3f0ff 100%);}
.feature-card:nth-child(3){border-color:#00d4ff;background:linear-gradient(135deg,#fff 0%,#f0fdff 100%);}
.feature-card:hover{transform:translateY(-8px);box-shadow:0 15px 35px rgba(0,0,0,0.15);}
.feature-title{font-size:22px;margin-bottom:15px;font-weight:bold;}
.feature-card:nth-child(1) .feature-title{color:#4a6cf7;}
.feature-card:nth-child(2) .feature-title{color:#6a11cb;}
.feature-card:nth-child(3) .feature-title{color:#00d4ff;}
.feature-description{opacity:0.8;font-size:15px;line-height:1.5;color:#475569;}
.cta-section{text-align:center;margin:60px 0;}
.cta-button{background:linear-gradient(45deg,#4a6cf7,#6a11cb);color:white;padding:18px 45px;font-size:18px;font-weight:bold;border:none;border-radius:50px;cursor:pointer;transition:all 0.3s ease;box-shadow:0 8px 25px rgba(74,108,247,0.3);}
.cta-button:hover{transform:translateY(-3px);box-shadow:0 12px 30px rgba(74,108,247,0.4);}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:1000;justify-content:center;align-items:center;}
.modal-content{background:white;padding:40px;border-radius:15px;width:90%;max-width:450px;box-shadow:0 20px 60px rgba(0,0,0,0.3);position:relative;}
.close-modal{position:absolute;top:15px;right:20px;font-size:24px;cursor:pointer;color:#666;}
.form-group{margin-bottom:20px;}
.form-group label{display:block;margin-bottom:8px;font-weight:bold;color:#475569;}
.form-group input{width:100%;padding:12px 15px;border:2px solid #e2e8f0;border-radius:8px;font-size:16px;transition:border-color 0.3s ease;}
.form-group input:focus{outline:none;border-color:#4a6cf7;}
.submit-btn{width:100%;background:linear-gradient(45deg,#4a6cf7,#6a11cb);color:white;padding:15px;font-size:16px;font-weight:bold;border:none;border-radius:8px;cursor:pointer;transition:all 0.3s ease;margin-top:10px;}
.submit-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(74,108,247,0.3);}
.submit-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none;}
.login-link{text-align:center;margin-top:20px;font-size:14px;color:#666;}
.login-link a{color:#4a6cf7;text-decoration:none;font-weight:bold;cursor:pointer;}
.message{padding:10px;border-radius:5px;margin:10px 0;text-align:center;display:none;}
.message.success{background:#d4edda;color:#155724;border:1px solid #c3e6cb;}
.message.error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;}
</style>
</head>
<body>
<div class="container">
<header>
<h1>FlowStack</h1>
<p class="subtitle">Modern Education for Digital Income</p>
</header>
<div class="cta-section">
<button class="cta-button" id="openSignupBtn">START YOUR JOURNEY</button>
</div>
</div>

<!-- Signup Modal -->
<div id="signupModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="closeSignupModal()">&times;</span>
<h2>Create Your Account</h2>
<div id="signupMessage" class="message"></div>
<form id="signupForm">
<div class="form-group">
<label for="fullName">Full Name</label>
<input type="text" id="fullName" required>
</div>
<div class="form-group">
<label for="email">Email</label>
<input type="email" id="email" required>
</div>
<div class="form-group">
<label for="password">Password</label>
<input type="password" id="password" required minlength="6">
</div>
<button type="submit" class="submit-btn">CREATE ACCOUNT</button>
</form>
<div class="login-link">
Already have an account? <a onclick="openLoginModal()">Log in</a>
</div>
</div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="closeLoginModal()">&times;</span>
<h2>Log In</h2>
<div id="loginMessage" class="message"></div>
<form id="loginForm">
<div class="form-group">
<label for="loginEmail">Email</label>
<input type="email" id="loginEmail" required>
</div>
<div class="form-group">
<label for="loginPassword">Password</label>
<input type="password" id="loginPassword" required>
</div>
<button type="submit" class="submit-btn">LOG IN</button>
</form>
<div class="login-link">
<a onclick="openForgotPasswordModal()">Forgot password?</a>
</div>
<div class="login-link">
Don't have an account? <a onclick="openSignupModal()">Sign up</a>
</div>
</div>
</div>

<!-- Forgot Password Modal -->
<div id="forgotPasswordModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="closeForgotPasswordModal()">&times;</span>
<h2>Reset Your Password</h2>
<div id="forgotPasswordMessage" class="message"></div>
<form id="forgotPasswordForm">
<div class="form-group">
<label for="forgotEmail">Email</label>
<input type="email" id="forgotEmail" required>
</div>
<button type="submit" class="submit-btn">SEND RESET LINK</button>
</form>
<div class="login-link">
Remember your password? <a onclick="openLoginModal()">Log in</a>
</div>
</div>
</div>

<!-- New Password Modal -->
<div id="newPasswordModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="closeNewPasswordModal()">&times;</span>
<h2>Set New Password</h2>
<div id="newPasswordMessage" class="message"></div>
<form id="newPasswordForm">
<div class="form-group">
<label for="newPassword">New Password</label>
<input type="password" id="newPassword" required minlength="6">
</div>
<div class="form-group">
<label for="confirmPassword">Confirm Password</label>
<input type="password" id="confirmPassword" required minlength="6">
</div>
<button type="submit" class="submit-btn">UPDATE PASSWORD</button>
</form>
</div>
</div>

<script>
// --- Supabase config ---
const supabaseUrl = 'https://mdvczbswbwbghschjthq.supabase.co';
const supabaseKey = 'YOUR_ANON_PUBLIC_KEY';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// --- Modal functions ---
function openSignupModal(){closeAllModals(); document.getElementById('signupModal').style.display='flex';}
function closeSignupModal(){document.getElementById('signupModal').style.display='none';}
function openLoginModal(){closeAllModals(); document.getElementById('loginModal').style.display='flex';}
function closeLoginModal(){document.getElementById('loginModal').style.display='none';}
function openForgotPasswordModal(){closeAllModals(); document.getElementById('forgotPasswordModal').style.display='flex';}
function closeForgotPasswordModal(){document.getElementById('forgotPasswordModal').style.display='none';}
function openNewPasswordModal(){closeAllModals(); document.getElementById('newPasswordModal').style.display='flex';}
function closeNewPasswordModal(){document.getElementById('newPasswordModal').style.display='none';}
function closeAllModals(){['signupModal','loginModal','forgotPasswordModal','newPasswordModal'].forEach(id=>document.getElementById(id).style.display='none');}

// --- CTA Button ---
document.getElementById('openSignupBtn').addEventListener('click',openSignupModal);

// --- Supabase Auth Functions ---
// SIGNUP
document.getElementById('signupForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const fullName=document.getElementById('fullName').value;
    const email=document.getElementById('email').value;
    const password=document.getElementById('password').value;
    try{
        const {data,error}=await supabase.auth.signUp({email,password,options:{data:{full_name:fullName},emailRedirectTo:'https://flowstackai.github.io/flowstack/'}});
        if(error) throw error;
        showMessage('signupMessage','ðŸŽ‰ Check your email to verify account!','success');
        document.getElementById('signupForm').reset();
    }catch(err){
        showMessage('signupMessage','Error: '+err.message,'error');
    }
});

// LOGIN
document.getElementById('loginForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const email=document.getElementById('loginEmail').value;
    const password=document.getElementById('loginPassword').value;
    try{
        const {data,error}=await supabase.auth.signInWithPassword({email,password});
        if(error) throw error;
        showMessage('loginMessage','âœ… Login successful!','success');
        setTimeout(closeLoginModal,2000);
    }catch(err){
        showMessage('loginMessage','Login failed: '+err.message,'error');
    }
});

// FORGOT PASSWORD
document.getElementById('forgotPasswordForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const email=document.getElementById('forgotEmail').value;
    try{
        const {error}=await supabase.auth.resetPasswordForEmail(email,{redirectTo:'https://flowstackai.github.io/flowstack/'});
        if(error) throw error;
        showMessage('forgotPasswordMessage','âœ… Reset link sent! Check your email.','success');
        document.getElementById('forgotPasswordForm').reset();
    }catch(err){
        showMessage('forgotPasswordMessage','Error: '+err.message,'error');
    }
});

// NEW PASSWORD
document.getElementById('newPasswordForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const newPassword=document.getElementById('newPassword').value;
    const confirmPassword=document.getElementById('confirmPassword').value;
    if(newPassword!==confirmPassword){
        showMessage('newPasswordMessage','Passwords do not match','error');
        return;
    }
    try{
        const token=sessionStorage.getItem('reset_token');
        if(!token){showMessage('newPasswordMessage','Invalid token','error'); return;}
        const {error}=await supabase.auth.updateUser({password:newPassword});
        if(error) throw error;
        showMessage('newPasswordMessage','âœ… Password updated! You can now log in.','success');
        sessionStorage.removeItem('reset_token');
        document.getElementById('newPasswordForm').reset();
        setTimeout(()=>{closeNewPasswordModal(); openLoginModal();},2000);
    }catch(err){
        showMessage('newPasswordMessage','Error: '+err.message,'error');
    }
});

// MESSAGE HELPER
function showMessage(id,msg,type){
    const el=document.getElementById(id);
    el.textContent=msg;
    el.className=`message ${type}`;
    el.style.display='block';
}

// --- DETECT PASSWORD RESET LINK ---
function handlePasswordReset(){
    if(window.location.hash.includes('type=recovery')){
        const hashParams={};
        window.location.hash.substring(1).split('&').forEach(pair=>{const [key,value]=pair.split('='); hashParams[key]=value;});
        if(hashParams.access_token) sessionStorage.setItem('reset_token',hashParams.access_token);
        openNewPasswordModal();
        setTimeout(()=>{window.history.replaceState({},document.title,window.location.pathname);},500);
    }
}
window.addEventListener('load',handlePasswordReset);
window.addEventListener('hashchange',handlePasswordReset);

</script>
</body>
</html>
